<html>

	<head>
		<title>psDeploy - Powershell deployment framework</title>
		<meta name="description" content="Powershell library to automate common deployment aspects and simplify your deployment scripts (Windows operations, IIS, logging...)." />
		
		<link type="text/css" rel="stylesheet" href="style.css"/>
		<link type="text/css" rel="stylesheet" href="header.css"/>
		<link type="text/css" rel="stylesheet" href="external/prettify/prettify.css" />
		
		<script type="text/javascript" src="external/prettify/prettify.js"></script>
		<script type="text/javascript" src="external/jquery/jquery-1.4.2.min.js"></script>
		<script>			
			$(document).ready(function() {
				prettyPrint();
			});
		</script>
		
	</head>
	
	<body>

		<a href="http://github.com/rprieto/psDeploy">
			<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" />
		</a> 

		<div id="header">
			<div id="header-title">
				<h1>psDeploy - deployment automation library</h1>
			</div>
			<div id="header-menu">
				<ul id="top">
					<li class="title">Home</li>
					<li><a href="index.html">Introduction</a></li>
					<li><a href="cmdlet-library.html">Cmdlet library</a></li>
					<li><span class="current">Framework</span></li>
					<li><a href="powershell-2-on-windows-xp-sp2.html">Windows XP</a></li>
				</ul>
				<ul id="bottom">
					<li class="title">Cmdlets</li>
					<li><a href="iis-6-cmdlets.html">IIS 6</a></li>
					<li><a href="windows-cmdlets.html">Windows</a></li>
					<li><a href="system-cmdlets.html">System</a></li>
					<li><a href="file-cmdlets.html">Files and folders</a></li>
					<li><a href="logging-cmdlets.html">Logging</a></li>
				</ul>
			</div>
		</div>

		<h2>Introduction</h2>
		
		<div class="section">
			
			<p>
				psDeploy contains both a library of cmdlets and a simple framework to drive deployments, which can either be used independently or together.
				The framework helps writing terse deployment scripts by automating common aspects such as logging and error handling.
			</p>
			
		</div>
		
		<h2>Simple template</h2>

		<div class="section">
		
			<p>
				Here is a simple template which illustrates a simple deployment script using <strong>psDeploy</strong>:
			
				<pre class="prettyprint code-standalone">
Set-StrictMode -Version 2
$ErrorActionPreference = 'Stop' 

Import-Module psDeploy

$psDeploy.Log.Name = 'Example2'
$psDeploy.Log.Journal = 'C:\Logs\Journal.txt'
$psDeploy.Log.Transcripts = 'C:\Logs\Transcripts'

deploy -transcript -journal -script {

    Write-Host "Doing stuff..."

} -success {
    
    Write-Host "Let's start testing"

} -failure {

    Write-Host "Please check the logs"

}
				</pre>
			</p>
			
			<p>
				This template illustrates the following common practices:
				
				<ul>
					<li>
						The use of Powershell's <a href="http://www.microsoft.com/technet/scriptcenter/topics/winpsh/strictmode.mspx">strict mode</a>, which validates the script's syntax
						and catches errors such as typos, undeclared variables and non-existent properties.
					</li>
					<li>
						Two-level logging for easier tracing and reference.
						<strong>psDeploy</strong> can help maintain a journal of all the script that have been run on a specific machine,
						a well as detailled logs of each individual deployment.
					</li>
					<li>
						Automatic error handling.
						The deployment will stop at the first error, and automatically display details such as the command that failed.
					</li>
					<li>
						Entry points to add <em>success</em> and <em>failure</em> behaviors, such as sending post-deployment emails.
					</li>
				</ul>
				
			</p>
			
		</div>
		
		<h2>Driving the deployments</h2>
		
		<div class="section">
		
			<p>
				Whether deploying from a local desktop, the CI server or any other machine, Powershell scripts usually need to be triggered externally. <br />
				A common way to do this is to call them from a DOS batch file, or from something similar to the ANT <span class="console">&lt;exec&gt;</span> task.
			</p>
			
			<p>
				It is recommended to call powershell the following way:
				<pre class="prettyprint code-standalone">
powershell.exe -NoProfile -ExecutionPolicy Unrestricted -File .\deploy.ps1
				</pre>
				
				This has the following advantages:
				
				<ul>
					<li>
						It runs the scripts in the exact same context as the Powershell ISE.
						Using other syntaxes might trigger unexpected behaviours, such as strict-mode or the default error action not being applied to imported modules.
						This could be the intended behaviour, but be aware of the differences with the ISE's "run" button.
					</li>
					<li>
						It disables the local prfile, which ensures the script will run exactly the same on any machine, without relying on local settings and aliases.
					</li>
					<li>
						It ignores the execution policy, which ensures the script will run even if it has not been signed.
						It is of course up to the team to decide on whether or not to sign the scripts, which can ensure they are not tempered with between environments.
					</li>
				</ul>
				
			</p>
			
		</div>
		
	</body>
	
</html>
