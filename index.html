<html>

	<head>
		<title>psDeploy - Powershell deployment automation library</title>
		
		<link type="text/css" rel="stylesheet" href="style.css"/>
		<link type="text/css" rel="stylesheet" href="header.css"/>
		<link type="text/css" rel="stylesheet" href="external/prettify/prettify.css" />
		
		<script type="text/javascript" src="external/prettify/prettify.js"></script>
		<script type="text/javascript" src="external/jquery/jquery-1.4.2.min.js"></script>
		<script>			
			$(document).ready(function() {
				prettyPrint();
			});
		</script>
		
	</head>
	
	<body>

		<a href="http://github.com/rprieto/psDeploy">
			<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" />
		</a> 

		<div id="header">
			<div id="header-title">
				<h1>psDeploy - deployment automation library</h1>
			</div>
			<div id="header-menu">
				<ul>
					<li><span class="current first">Home</span></li>
					<li><a href="iis-6-cmdlets.html">IIS 6 cmdlets</a></li>
					<li><a href="windows-cmdlets.html">Windows cmdlets</a></li>
					<li><a href="file-cmdlets.html">File cmdlets</a></li>
				</ul>
			</div>
		</div>
	
		<h2>Introduction</h2>
	
		<div class="section">
	  
			<p>
				<strong>psDeploy</strong> is a deployment automation library for Powershell.
				This small-footprint package provides additional cmdlets for common interaction with Windows during deployment processes.
				Adding the <strong>psDeploy</strong> module to your development / test / production servers
				allows you to automate the teardown or setup of your environments,
				thus limiting the need for manual configuration and documentation.
			</p>
			
			<p>
				This module adds several commandlets (cmdlets), which are grouped into main categories:
			</p>
			
			<ul>
				<li><a href="iis-6-cmdlets.html">IIS 6</a> (websites, app pools...)</li>
				<li><a href="windows-cmdlets.html">Windows automation</a> (users, services...)</li>
				<li><a href="file-cmdlets.html">File based operations</a> (archives...)</li>
			</ul>

		</div>

		<h2>Requirements</h2>
		
		<div class="section">
		
			<p>
				The main requirement of <strong>psDeploy</strong> is Powershell 2.0. <br />
				Powershell 2.0 officially requires at least the following versions of Windows:
			</p>

			<ul>
				<li>Windows XP Service Pack 3</li>
				<li>Windows Vista Service Pack 1</li>
				<li>Windows Server 2003 Service Pack 2</li>
				<li>Windows Server 2008 Service Pack 1</li>
			</ul>
			
			<p>
				However, it is possible to install Powershell 2 on Windows XP SP2 by following
				<a href="powershell-2-on-windows-xp-sp2.html">these steps</a>.
			</p>
			
		</div>

		<h2>How to use psDeploy</h2>

		<div class="section">

			<ol>
				<li>Install Powershell 2.0 if necessary, from <a href="http://support.microsoft.com/kb/968929">http://support.microsoft.com/kb/968929</a></li>
				<li>Go to the psDeploy <a href="http://github.com/rprieto/psDeploy/downloads">download page</a> and download the latest version</li>
				<li>Extract the <span class="caps">ZIP</span> contents to any of the powershell module paths, which you can list with <span class="console">$env:psmodulepath</pre></li>
				<li>Add the following line at the top of your script:</li>
			</ol>

			<pre class="prettyprint code-standalone">Import-Module psDeploy
			</pre>
			
		</div>


		<h2 style="color:orange;">Simple examples</h2>

		<div class="section">

			<p>
				<strong>psDeploy</strong> simply adds new cmdlets that can be used within a deployment scripts, such as:
			</p>

			<pre class="prettyprint code-standalone">
Stop-IIS6AppPool -Name "MyPool"
New-LocalUser -Name "Bob" -Password "123456"
Expand-Zip -File "C:\Builds\Version3.zip" -Destination "C:\MyService" -CleanDestinationFirst
New-ScheduledTask -Name "MyTask" -Path "C:\Task.exe" -Every 2 -Weeks -On "Mon,Wed" -At 18:30
			</pre>
				
			<p>The commandlets will usually have one of the following outcome:</p>

			<ul>
				<li>Be successful and print a success message, for ex. <span class="console">Created new user 'Bill'</span></li>
				<li>Print a message if no action was taken, for ex. <span class="console">The app pool 'MyWeb' was already stopped</span></li>
				<li>Throw an exception detailing the reason of the failure</li>
			</ul>
				
		</div>


		<h2>Common deployment aspects</h2>
		
		<div class="section">
			
			<p>
				The default behaviour in Powershell is to keep going after an error occurs.
				Adding the following lines to the top of the deployment script should ensure that the deployment stops at the first failure:
				<pre class="prettyprint code-standalone">
$ErrorActionPreference = 'Stop'
Trap [Exception]
{
    Write-Warning "The deployment failed"
    $Error | Write-Error
    break
}
				</pre>
			</p>
			
			<p>
				Another common need during deployments is to log everything that happens during the process. <br />
				The <a href="file-cmdlets.html">Files</a> section of <strong>psDeploy</strong> contains a <em>Start-Log</em> cmdlet
				which captures the whole output to a file that can be analysed later.
				<pre class="prettyprint code-standalone">
Start-Log -Path "C:\Logs" -Name "AppX_Deployment_" -AppendDate
				</pre>
			</p>
			
			<p>
				Finally, it is recommended to add the following line to the top of any deployment script. <br />
				This will validate the script's syntax and catch typos, undeclared variables, non-existent properties...
				<pre class="prettyprint code-standalone">
Set-StrictMode -Version 2.0
				</pre>
			</p>

		</div>
		
		
		<h2>Additional notes</h2>
		
		<div class="section">
		
			<p>
				<strong>psDeploy</strong> is still in early stages of development.
				Unfortunately this means some cmdlet or parameter names might change occasionally.
				However it also means that the library is constantly growing and improving!
				Please feel free to post ideas of useful cmdlets, or to file <a href="http://github.com/rprieto/psDeploy/issues">bug reports</a>.
			</p>

		</div>
		
	</body>
	
</html>
